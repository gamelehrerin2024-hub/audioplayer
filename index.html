<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Genially Player Configurator</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background: #0f172a; color: #f8fafc; display: flex; justify-content: center; padding: 40px; }
        .config-card { background: #1e293b; padding: 30px; border-radius: 20px; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5); width: 100%; max-width: 500px; border: 1px solid #334155; }
        h1 { font-size: 24px; color: #38bdf8; text-align: center; margin-bottom: 30px; }
        .field { margin-bottom: 20px; }
        label { display: block; font-size: 12px; text-transform: uppercase; color: #94a3b8; margin-bottom: 8px; font-weight: bold; }
        input, select { width: 100%; padding: 12px; background: #0f172a; border: 1px solid #334155; border-radius: 8px; color: #fff; box-sizing: border-box; }
        button { width: 100%; padding: 15px; background: #38bdf8; color: #0f172a; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; transition: 0.3s; margin-top: 10px; font-size: 16px; }
        button:hover { background: #7dd3fc; transform: translateY(-2px); }
        #output-area { margin-top: 30px; display: none; }
        textarea { width: 100%; height: 120px; background: #000; color: #4ade80; border-radius: 8px; padding: 10px; font-family: monospace; font-size: 12px; border: 1px solid #166534; resize: none; }
        .copy-hint { font-size: 11px; color: #4ade80; margin-bottom: 5px; display: block; }
    </style>
</head>
<body>

<div class="config-card">
    <h1>üéß Player Builder</h1>
    
    <div class="field">
        <label>GitHub Audio Folder URL</label>
        <input type="text" id="gh_path" placeholder="https://github.com/user/repo/tree/main/audio" value="https://github.com/gamelehrerin2024-hub/audioplayer/tree/main/audio">
    </div>

    <div class="field">
        <label>Player Theme Color</label>
        <input type="color" id="theme_color" value="#38bdf8">
    </div>

    <div class="field">
        <label>Interface Language</label>
        <select id="ui_lang">
            <option value="en">English</option>
            <option value="de">Deutsch</option>
            <option value="ru">–†—É—Å—Å–∫–∏–π</option>
        </select>
    </div>

    <button onclick="generateCode()">GENERATE IFRAME CODE</button>

    <div id="output-area">
        <label class="copy-hint">‚úì Ready! Copy this to Genially (Insert > Others):</label>
        <textarea id="result_code" readonly></textarea>
    </div>
</div>

<script>
function generateCode() {
    const ghUrl = document.getElementById('gh_path').value.trim();
    const accent = document.getElementById('theme_color').value;
    const lang = document.getElementById('ui_lang').value;

    if (!ghUrl) return alert("Please enter GitHub URL");

    // –ü–∞—Ä—Å–∏–º –ø—É—Ç—å –≥–∏—Ç—Ö–∞–±–∞
    const parts = ghUrl.replace('https://github.com/', '').split('/');
    const user = parts[0], repo = parts[1], branch = parts[3], path = parts.slice(4).join('/');
    
    const api = `https://api.github.com/repos/${user}/${repo}/contents/${path}?ref=${branch}`;
    const raw = `https://raw.githubusercontent.com/${user}/${repo}/${branch}/${path}`;

    // –¢–µ–∫—Å—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
    const texts = {
        en: { playlist: "Playlist", loading: "Loading..." },
        de: { playlist: "Wiedergabeliste", loading: "Laden..." },
        ru: { playlist: "–ü–ª–µ–π–ª–∏—Å—Ç", loading: "–ó–∞–≥—Ä—É–∑–∫–∞..." }
    };

    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º HTML —Å–∞–º–æ–≥–æ –ø–ª–µ–µ—Ä–∞
    const playerHtml = `
<div style="width:360px; background:rgba(255,255,255,0.98); border-radius:24px; overflow:hidden; font-family:'Inter', sans-serif; box-shadow:0 15px 45px rgba(0,0,0,0.1); border:1px solid #eee;">
    <div style="height:140px; background:linear-gradient(rgba(0,0,0,0.3),rgba(0,0,0,0.7)), url('${raw}/cover.jpg') center/cover, #2c3e50; display:flex; align-items:flex-end; padding:20px; position:relative;">
        <a id="dl" href="#" download style="position:absolute; top:20px; left:20px; text-decoration:none; color:#fff; background:rgba(255,255,255,0.2); width:32px; height:32px; border-radius:50%; display:flex; align-items:center; justify-content:center; backdrop-filter:blur(5px); font-size:16px;">‚¨á</a>
        <span style="position:absolute; top:20px; right:20px; color:${accent}; font-size:20px; cursor:default;">‚ù§</span>
        <div style="display:flex; align-items:center; gap:12px; color:#fff; z-index:2;">
            <div style="width:55px; height:55px; border-radius:12px; background:url('${raw}/cover.jpg') center/cover, #444; border:1px solid rgba(255,255,255,0.3);"></div>
            <div style="overflow:hidden;">
                <div id="ti" style="font-weight:bold; font-size:16px; width:220px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; text-shadow:0 2px 4px rgba(0,0,0,0.5);">${texts[lang].loading}</div>
                <div style="font-size:11px; opacity:0.8; text-transform:uppercase; letter-spacing:1px;">${texts[lang].playlist}</div>
            </div>
        </div>
    </div>
    <div style="padding:20px; background:#fff;">
        <div style="display:flex; align-items:center; gap:10px; margin-bottom:15px;">
            <span id="ct" style="font-size:10px; color:#94a3b8; width:35px;">0:00</span>
            <input type="range" id="sk" value="0" style="flex-grow:1; accent-color:${accent}; height:4px; cursor:pointer;">
            <span id="dt" style="font-size:10px; color:#94a3b8; width:35px;">0:00</span>
        </div>
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <div id="vc" style="position:relative; display:flex; align-items:center; width:20px; cursor:pointer;">
                <span style="font-size:18px;">üîä</span>
                <input type="range" id="vl" min="0" max="1" step="0.05" value="0.8" style="width:0; opacity:0; accent-color:${accent}; transition:0.3s; position:absolute; left:25px;">
            </div>
            <div style="display:flex; align-items:center; gap:15px;">
                <button onclick="window.pN()" style="background:none; border:none; font-size:28px; cursor:pointer; color:#1e293b;">‚èÆ</button>
                <button id="pb" onclick="window.pT()" style="background:#1e293b; color:#fff; width:52px; height:52px; border-radius:50%; border:none; font-size:24px; cursor:pointer; display:flex; align-items:center; justify-content:center; box-shadow:0 10px 20px rgba(0,0,0,0.1);">‚ñ∂</button>
                <button onclick="window.pX()" style="background:none; border:none; font-size:28px; cursor:pointer; color:#1e293b;">‚è≠</button>
            </div>
            <span id="sf" style="cursor:pointer; font-size:18px; color:#cbd5e1;">üîÄ</span>
        </div>
    </div>
    <audio id="au"></audio>
</div>
<style>
 #vc:hover #vl { width:60px; opacity:1; }
 input[type=range] { -webkit-appearance:none; outline:none; background:#f1f5f9; border-radius:10px; }
</style>
<script>
(function(){
    const a=document.getElementById('au'), b=document.getElementById('pb'), s=document.getElementById('sk'), t=document.getElementById('ti'), v=document.getElementById('vl'), dl=document.getElementById('dl');
    let trk=[], cur=0, isS=false;
    fetch('${api}').then(r=>r.json()).then(d=>{
        trk=d.filter(f=>f.name.endsWith('.mp3')).map(f=>({n:f.name.replace('.mp3',''), u:f.download_url}));
        if(trk.length) l(0);
    });
    function l(i){ cur=i; a.src=trk[i].u; t.innerText=trk[i].n; dl.href=trk[i].u; a.load(); }
    window.pT=()=>{ if(a.paused){ a.play(); b.innerText='‚è∏'; } else { a.pause(); b.innerText='‚ñ∂'; } };
    window.pX=()=>{ cur=isS?Math.floor(Math.random()*trk.length):(cur+1)%trk.length; l(cur); a.play(); b.innerText='‚è∏'; };
    window.pN=()=>{ cur=(cur-1+trk.length)%trk.length; l(cur); a.play(); b.innerText='‚è∏'; };
    a.ontimeupdate=()=>{ s.value=(a.currentTime/a.duration)*100||0; document.getElementById('ct').innerText=f(a.currentTime); };
    a.onloadedmetadata=()=>{ document.getElementById('dt').innerText=f(a.duration); };
    a.onended=()=>window.pX();
    s.oninput=()=>{ a.currentTime=(s.value/100)*a.duration; };
    v.oninput=()=>{ a.volume=v.value; };
    document.getElementById('sf').onclick=(e)=>{ isS=!isS; e.target.style.color=isS?'${accent}':'#cbd5e1'; };
    function f(s){ let m=Math.floor(s/60), sc=Math.floor(s%60); return m+':'+String(sc).padStart(2,'0'); }
})();
<\/script>`;

    // –§–æ—Ä–º–∏—Ä—É–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π iframe –∫–æ–¥
    const iframeCode = `<iframe srcdoc='${playerHtml.replace(/'/g, "&apos;").replace(/<\/script>/g, '<\\/script>')}' width="400" height="380" style="border:none; background:transparent;" allow="autoplay"></iframe>`;
    
    document.getElementById('result_code').value = iframeCode;
    document.getElementById('output-area').style.display = 'block';
}
</script>

</body>
</html>
