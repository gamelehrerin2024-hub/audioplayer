<div id="ULTIMATE_BUILDER" style="font-family: 'Inter', sans-serif; background: #121214; padding: 25px; border-radius: 20px; color: #fff; max-width: 480px; margin: auto; border: 1px solid #333; box-shadow: 0 20px 50px rgba(0,0,0,0.6);">
    <h2 style="text-align: center; color: #7ed6df; margin-top: 0; letter-spacing: 1px;">Audio Studio + Download</h2>
    
    <div style="display: flex; flex-direction: column; gap: 15px;">
        <div>
            <label style="font-size: 10px; color: #7ed6df; font-weight: bold; text-transform: uppercase;">GitHub Folder URL:</label>
            <input type="text" id="gh_path" style="width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #444; background: #000; color: #fff; margin-top: 5px; box-sizing: border-box;" placeholder="https://github.com/user/repo/tree/main/audio">
        </div>
        
        <div style="display: flex; gap: 10px;">
            <div style="flex: 1;">
                <label style="font-size: 10px; color: #7ed6df; font-weight: bold;">ACCENT COLOR:</label>
                <input type="color" id="clr" value="#7ed6df" style="width: 100%; height: 40px; border: none; cursor: pointer; background: transparent;">
            </div>
            <div style="flex: 1;">
                <label style="font-size: 10px; color: #7ed6df; font-weight: bold;">INTERFACE:</label>
                <select id="lang" style="width: 100%; height: 40px; background: #000; color: #fff; border: 1px solid #444; border-radius: 8px; width: 100%;">
                    <option value="RU">–†—É—Å—Å–∫–∏–π</option>
                    <option value="DE">Deutsch</option>
                </select>
            </div>
        </div>
        
        <button onclick="buildPlayer()" style="padding: 15px; background: #7ed6df; color: #000; border: none; border-radius: 10px; font-weight: 900; cursor: pointer; text-transform: uppercase; transition: 0.3s;" onmouseover="this.style.opacity='0.8'" onmouseout="this.style.opacity='1'">–°–æ–∑–¥–∞—Ç—å –≤–∏–¥–∂–µ—Ç</button>
    </div>

    <div id="res_area" style="display: none; margin-top: 20px; border-top: 1px solid #333; padding-top: 20px;">
        <label style="font-size: 11px; color: #7ed6df;">–°–ö–û–ü–ò–†–£–ô–¢–ï –≠–¢–û–¢ –ö–û–î:</label>
        <textarea id="res_code" readonly style="width: 100%; height: 90px; background: #000; color: #00ffaa; font-family: monospace; font-size: 10px; border: 1px solid #444; padding: 10px; margin-top: 10px; box-sizing: border-box;"></textarea>
    </div>
</div>

<script>
function buildPlayer() {
    const url = document.getElementById('gh_path').value.trim();
    const accent = document.getElementById('clr').value;
    
    if(!url.includes('github.com')) { alert('Please enter valid GitHub URL'); return; }

    const parts = url.replace('https://github.com/', '').split('/');
    const user = parts[0], repo = parts[1], branch = parts[3], path = parts.slice(4).join('/');
    const api = `https://api.github.com/repos/${user}/${repo}/contents/${path}?ref=${branch}`;
    const rawBase = `https://raw.githubusercontent.com/${user}/${repo}/${branch}/${path}`;

    const player = `
<div style="width:350px; background:rgba(255,255,255,0.98); border-radius:24px; overflow:hidden; font-family:sans-serif; box-shadow:0 15px 45px rgba(0,0,0,0.15); border:1px solid #eee;">
    <div style="height:140px; background:linear-gradient(rgba(0,0,0,0.3),rgba(0,0,0,0.7)), url('${rawBase}/cover.jpg') center/cover, #2c3e50; display:flex; align-items:flex-end; padding:20px; position:relative;">
        <a id="dl" href="#" download style="position:absolute; top:20px; left:20px; text-decoration:none; color:#fff; background:rgba(255,255,255,0.2); width:30px; height:30px; border-radius:50%; display:flex; align-items:center; justify-content:center; backdrop-filter:blur(5px); font-size:14px;">‚¨á</a>
        <span style="position:absolute; top:20px; right:20px; color:${accent}; font-size:20px; cursor:pointer;">‚ù§</span>
        <div style="display:flex; align-items:center; gap:12px; color:#fff; z-index:2;">
            <div style="width:55px; height:55px; border-radius:12px; background:url('${rawBase}/cover.jpg') center/cover, #444; border:1px solid rgba(255,255,255,0.3);"></div>
            <div style="overflow:hidden;">
                <div id="ti" style="font-weight:bold; font-size:16px; width:220px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; text-shadow:0 2px 4px rgba(0,0,0,0.5);">Loading...</div>
                <div style="font-size:11px; opacity:0.8; text-transform:uppercase;">Playlist</div>
            </div>
        </div>
    </div>
    <div style="padding:20px; background:#fff;">
        <div style="display:flex; align-items:center; gap:8px; margin-bottom:15px;">
            <span id="ct" style="font-size:10px; color:#999; width:35px;">0:00</span>
            <input type="range" id="sk" value="0" style="flex-grow:1; accent-color:${accent}; height:4px; cursor:pointer;">
            <span id="dt" style="font-size:10px; color:#999; width:35px;">0:00</span>
        </div>
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <div id="vc" style="position:relative; display:flex; align-items:center; width:20px;">
                <span style="cursor:pointer; font-size:16px;">üîä</span>
                <input type="range" id="vl" min="0" max="1" step="0.05" value="0.8" style="width:0; opacity:0; accent-color:${accent}; transition:0.3s; position:absolute; left:25px;">
            </div>
            <div style="display:flex; align-items:center; gap:15px;">
                <button onclick="window.pN()" style="background:none; border:none; font-size:24px; cursor:pointer; color:#333;">‚èÆ</button>
                <button id="pb" onclick="window.pT()" style="background:#333; color:#fff; width:50px; height:50px; border-radius:50%; border:none; font-size:22px; cursor:pointer; box-shadow:0 4px 10px rgba(0,0,0,0.2);">‚ñ∂</button>
                <button onclick="window.pX()" style="background:none; border:none; font-size:24px; cursor:pointer; color:#333;">‚è≠</button>
            </div>
            <span id="sf" style="cursor:pointer; font-size:16px; color:#ccc;">üîÄ</span>
        </div>
    </div>
    <audio id="au"></audio>
</div>
<style>
 #vc:hover #vl { width:60px; opacity:1; }
 input[type=range] { -webkit-appearance:none; outline:none; background:#eee; border-radius:10px; }
</style>
<script>
(function(){
    const a=document.getElementById('au'), b=document.getElementById('pb'), s=document.getElementById('sk'), t=document.getElementById('ti'), v=document.getElementById('vl'), dl=document.getElementById('dl');
    let trk=[], cur=0, isS=false;
    fetch('${api}').then(r=>r.json()).then(d=>{
        trk=d.filter(f=>f.name.endsWith('.mp3')).map(f=>({n:f.name.replace('.mp3',''), u:f.download_url}));
        if(trk.length) l(0);
    });
    function l(i){ cur=i; a.src=trk[i].u; t.innerText=trk[i].n; dl.href=trk[i].u; a.load(); }
    window.pT=()=>{ if(a.paused){ a.play(); b.innerText='‚è∏'; } else { a.pause(); b.innerText='‚ñ∂'; } };
    window.pX=()=>{ cur=isS?Math.floor(Math.random()*trk.length):(cur+1)%trk.length; l(cur); a.play(); b.innerText='‚è∏'; };
    window.pN=()=>{ cur=(cur-1+trk.length)%trk.length; l(cur); a.play(); b.innerText='‚è∏'; };
    a.ontimeupdate=()=>{ s.value=(a.currentTime/a.duration)*100||0; document.getElementById('ct').innerText=f(a.currentTime); };
    a.onloadedmetadata=()=>{ document.getElementById('dt').innerText=f(a.duration); };
    a.onended=()=>window.pX();
    s.oninput=()=>{ a.currentTime=(s.value/100)*a.duration; };
    v.oninput=()=>{ a.volume=v.value; };
    document.getElementById('sf').onclick=(e)=>{ isS=!isS; e.target.style.color=isS?'${accent}':'#ccc'; };
    function f(s){ let m=Math.floor(s/60), sc=Math.floor(s%60); return m+':'+String(sc).padStart(2,'0'); }
})();
<\/script>`;

    document.getElementById('res_code').value = `<iframe srcdoc='${player.replace(/'/g, "&apos;").replace(/<\/script>/g, '<\\/script>')}' width="380" height="360" style="border:none; background:transparent;" allow="autoplay"></iframe>`;
    document.getElementById('res_area').style.display = 'block';
}
</script>
